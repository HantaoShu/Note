# Linux指令
## 常规指令
#### ls
- -d 显示目录而非文件数据
- -h 用gb,mb显示
- -i  显示inode号
- -R 同时显示子目录
- -n 列出UID和GID
---
#### cp
- -a 相当于pdr
- -d 若为link file 则复制连接文件而非本身
- -f 强制
- -i 若以存在 则询问
- -l 以硬连接复制
- -s 以软链接复制
- -p 将文件属性一起复制 用于备份
- -u 当目的文件旧才复制
---
### cat tac 
- -b 打印行号 包括空白行
- -**n 打印行号 不包括空白行**
- -E 将断行符号用$显示
- -T 将tab符号用^I显示
- -v 显示一些看不出来的特殊字符
- -a 相当于-vTE
---
#### more
- space 向下一页
- Enter 向下一行
- :f 显示行数
- b 或 ctrl-b 向上翻页
----
#### less 
- [PageDown] 向下翻页
- [PageUp] 向上翻页
- / 向下查询
- ? 向上查询
- n N  重复查询
----
#### tail
- -f 持续检测后面的文件 只要有更新就在终端显示
---
#### sed 处理文本的工具
  - sed[n1,[,n2]] function
  - n1 n2 代表行
  - function
    - a 新增 在下一行出现 后接字符串 可用\插入多行
    - i 新增 在上一行出现 后接字符串 可用\插入多行
    - c 替换 替换在n1-n2之间的行 后接字符串 可用\插入多行
    - d 删除
    - p 打印
    - s 正则表达式替换  如 1,20**s/**old**/**new**/g**
---
#### awk
使用 awd 'condition1{action1} condition2 {action2}' filename  
awk 用于处理没一行的字段(空格或者tab)  
数据位于$1$2..  
NF 没一行有多少字段  
NR 当前处理第几行  
FS 分隔符号  
可以使用数值逻辑符号作为condtion如 &lt; &gt; == 与变量比较($1)   

#### diff 比较文本
  - diff [-bBi] file1 file2
    - b 忽略一行中的空白
    - B 忽略空行
    - i 忽略大小写
---
#### cmp 按字节比较文件
 
#### ln 
- 分软连接和硬连接 
- 硬连接是新建一个文件并与inode连接 不可连接到目录 不可跨文件系统
- 软连接 又叫符号连接 类似快捷方式 会占用inode 和block 可以连接目录 删除源文件后无法使用
----
## 文件系统
  #### 常规使用
- mtime上次内容数据更改时间
- ctime 状态数据被更改的时间
- atime 内容被读取的时间 
- 目录的x权限代表能否进入

#### 隐藏属性
- chattr 设置文件隐藏属性
  - +- 在原有下增删一个参数 =直接就是后面的参数
  - A:atime 不会随读取更改
  - S:数据是异步写入磁盘
  - **a:数据只能增加,不能删除或修改数据 只有在root下才能设置** 
  - c:读取和写入会自动解压/压缩后在进行操作
  - d:当dump执行时,此文件不会被备份
  - **i:使文件不会被删除、改名、连接 无法写入修改数据 只有root才能设置**
  - s:当文件被删除后,会被完全删除
  - u:当文件被删除后,可以找回文件
- lsattr 显示文件隐藏属性
  - -a 显示隐藏文件
  - -d 显示目录属性
  - -R 显示子文件属性
- SetUID
  - s会出现在文件所有者的x属性上 且只有对二进制文件有效(对于shell script无效) 只在执行过程中有效
  - 效果:执行者在执行过程中会得到程序所有者的权限
- SetGID
  - SGID可以对文件或者目录进行操作
  - 对于文件 SGID对二进制程序有用 对于使用者需要得到x权限 当使用者使用时能得到用户组的支持
  - 对于目录
  - 当用户对于该目录具有rx权限就能进入 用户在此目录下的有效用户组会变为目录的用户组 用户会拥有w权限 且生成文件与原目录用户组相同
 -SetBit
  - 只对目录有效 
  - 当用户创建文件或目录时只有自己和root才有权删除文件
- 使用
  - 在chmod中再加一位在最前面 其中4 SUID 2 SGID 1 SBIT
---
## 搜索指令
#### whereis locate
#### find 
- 参数 时间 [acm]time  n代表n天前的那一天  +n代表n天之前 -n代表n天之后 -newer file 比file前的
- 文件权限及名称 -size -name -type (f,b,c,d,l,s,p) -mode(读写权限)  -mode (-全部拥有 +至少拥有1)  
- 用户 -uid -gid -user -group -nouser -nogroup 文件所有者或组不在passwd中的
- 其他 -exec 后面跟其他命令 -print 打印到屏幕(默认)
----
## 硬盘指令 
#### df 列出磁盘使用量 
- -h 用合适的kb,mb,gb代替
- -H 用1000代替1024进位 
- -T  显示文件系统 
- -i 不用硬盘容量用inode显示
#### du 显示文件的容量 
- -a 列出文件和目录(默认只有文件)
- -h 用合适的kb,mb,gb代替
- -s只显示总量 
- -S不包括子目录下的统计 
#### fdisk 进行磁盘分区的
- mkfs (-t格式) 设备 磁盘格式化 -a/y 自动修复 -C显示进度
#### mount 磁盘挂载与卸载
- -a 按照/etc/fstab 的数据进行挂载
- -t 指定文件系统
- -n 不写入/etc/mtab 中
- -L 用设备名
- -o 添加参数
- **挂在u盘 mount -t vfat -o iocharset=cp950 /... /...**
- **卸载 umount /....**
---
## 压缩
- *.Z compress程序压缩的文件
- *.gz gzip程序压缩的文件
- *.bz2 bzip2程序压缩的文件
- *.tar tar程序打包的数据,并没有经过压缩
- *.tar.gz tar程序打包的文件,其中经过了gzip的压缩
- *.tar.bz2 tar程序打包的文件,其中经过了bzip2的压缩
 
#### compress 压缩
- -r  连同目录一起压缩
- -c 将压缩数据输出成为 std output 输出到屏幕 可利用重定向
- -v 显示压缩信息打印并显示压缩中文件变化
- uncompress 解压缩

#### gizp
- -c 将压缩数据输出成std output 输出到屏幕 可利用重定向
- -d 解压缩
- -t 检验压缩文件的一致性
- -# 压缩等级 速度也压缩比
- zcat 将文本压缩文件读出来

#### bzip2 bzcat 同上

#### tar 用于打包和压缩
- -c 新建打包文件
- -x 解压
- -v 显示打包过程中的文件名
- -t 查看打包文件内容内有哪些文件名
- -j 通过bzip2的支持进行压缩/解压缩
- -z 通过gzip的支持进行压缩/解压缩
- -p 保存原本权限和属性
- -P 保留绝对路径  解压后会出现在绝对路径中
- -f 直接接被处理的文件名
- -C 直接接生成的路径
- **tar -zcvf file **
- **tar -zxvf file **
--- 
## 备份
#### dump 
- -W 显示在/etc/fstab 里面的具有dump设置的分区是否备份过
- -S  显示需要多少磁盘空间
- -v 显示过程
- -j 加入bzip的压缩支持
- -level 设置等级 level 与之前一个等级进行比较
- -f 接设备名
- -u 将时间记录到 /etc/dumpdateS 中

#### restore 
- -t 查看备份文件中有那些数据
- -C 将dump与实际文件系统比较
- -i 进入互动模式
- -r 将整个文件系统还原
- -f 直接接dump文件
- -h 显示详细信息
--- 
- dd 将一个设备备份成文件
- dd if="" of="" bs="block size" count="number:
---

## 编码
- 中文 LANG=zh_CN.bih5

---
#### Dos和Linux 断行符号
  - Linux下只有 LF($) 这个符号  Dos 下有CRLF(^M$) 这样的断行符号
  - 所以需要格式转换
  - dos2UNIX [-kn] file [newfile]
  - -k 代表保留原文本mtime
  - -n 代表有newfile
--- 
#### 语系编码  iconv 
- --list 显示支持的语系
- -f 原编码
- -t 现编码
- -o 保存原文件
---

## Bash  
#### 变量 双引号仍能保留原有变量的内容 而单引号不能  
#### 在命令中 反单引号(`) 中的内容会优先执行  
#### env 查看当期的环境目录  
#### set 
  - 若要使用 则set -. 若不使用 set+.
  - -u 使用为设置变量会显示错误信息　默认不启用
　- -v 在讯息输出前　显示原始内容　默认不启用
  - -x 执行命令前回显指令　默认不启用
  - -C 若使用> 若文件以存在则不覆盖
---
#### Bash快捷键
  - ctrl+U 清除当前指令
  - ctrl+S 暂停当前输出
  - ctrl+Q 回复当前输出
---
#### Bash判断式
  - cmd1&&cmd2||cmd3
  
---
#### sort 
  - -f 忽略大小写
  - -b 忽略空格
  - -M 以月份名字排序
  - -n 以数字排序(默认文本)
  - -r 反向
  - -t 分隔符 默认tab分隔
  - -k 第几个区域排序
---
#### uniq 将重复的数据只显示一个
 - -i 忽略大小写
 - -o 进行技术
---
#### wc
  - -l 行 -w 单词 -m 字符

---
#### tr 对一段文字进行转换
  - -c 反义 指未在source 中的字符
  - -d 删除 之后文字
  - -s 替换
---
#### col -x 将tab 转为空格 

#### join [-ti12] file1 file2 将file1 和file2 中有相同的数据进行合并
  - -t 默认以空格分隔数据 可用-t 制定区分符号
  - -i 忽略大小写
  - -# 第几个放在前面

#### paste 将两个文件贴在一起 以tab分隔

#### expand -t 将tab换成一定量的空格

#### xarfs command 将其作为参数
  - -0 若出现特殊字符 如空格 转换为一般字符
  - -e 当分析到后面的字符串就当做遇到EOF
  - -p 每次询问用户
  - -n 后面接次数
---

#### -的用处  可以代替stdin和stdout  

#### grep
  - -E 用扩展正则表达式
  - -f 后接file 
  - -qs 不显示错误信息
---
#### fmt 格式化段落 -w 输出行的宽度


## Shell 编程
#### var=$(()) 进行运算

#### test
  ###### 可判断文件类型
  - -e 存在
  - -f 文件
  - -d 目录
  - -L 连接  
  ###### 权限 
  - -rwx
  - -u SUID
  - -g SGID
  - -k stick bit
  - -s 非空白
  ###### 比较
  - -nt 新
  - -ot 旧
  - -ef 是否为同一文件 hard link  
  ###### 整数
  - -eq -ne -gt -lt -ge -le
  ###### 字符串
  Test -z 是否为0 空串返回true  
  Test -n 是否非0 空串返回false  
  test str1=str2  
  test str1!=str2 
  ###### 多重
  -a 与
  -o 或
  ! 非
---
#### 判断符号[]
  - 注意空格 在中括号左右要有空格
  - 注意将变量用"" '' 
---
#### 脚本的参数 $number  
- $# 代表参数个数
- $@ 代表 "$1","$2","$3","$4"
- $* 代表"$1c$2c$3c$" c是分隔符 默认空格

#### shift number 将位置较低的变量删除
#### if
<code>if [ cmd ]; then  
  elif [cmd ]; then  
  else   
  fi 
</code>
#### case 
<code>case $x in   
    "")  
    ;;  
    "")  
    ;;  
  esac  
</code>
#### function 
<code>function fname(){
  
}
</code>

**function 有内置的变量$0 $1 和bash不一样** 
#### Loop
  ###### while do done
  <code>while [ condition ]  
  do  
  done  
  </code>
  
  ###### until
  <code>until [ condition ]  
  do  
  done
  </code>
  ###### for do done
  <code>for var in con1 con2 con3  
  do  
  done
  </code>
  <code> for ((;;;))  
  do  
  done  
  </code>

#### 跟踪与调试 
sh [-nvx] script.sh  
  - -n 仅检查语法
  - -v 执行前将script 输出到屏幕
  - -x 将用到的script 显示到屏幕上(用于调试)  
在script 中用set -x 和set +x 可以打开或关闭调试功能
---
## 包管理软件 
#### rpm 和 srpm
rpm是红帽出的一款包管理软件,他将软件内容预先编译并且能较好处理依赖.
由于rpm对硬件及系统版本有要求,故我们可以使用srpm是将软件源码进行下载,再将源码根据我们的环境进行编译生成rpm文件
- rpm 安装
    - rpm -ivh name  i代表install v 显示安装信息 h显示进度
    - 若出现问题可以强制安装 
- rpm 验证
    - 验证安装软件是否正确 是否有篡改
    - rmp -Va 
    - 如果有篡改 会显示出8种可能被篡改的类型

    

## 后台
#### jobs 显示后台进程
  - -l 显示细节
  - -r 显示正在运行的进程
  - -s 显示暂停进程
---
#### fg %jobnumber 将后台进程放进前台

#### bg %jobnumber 将后台暂停进程运行

#### kill -signal %jobnumber 杀死进程
  - -l 能使用的信号有哪些
  - -1 重新读取配置文件
  - -2 进行ctrl-C
  - -9 强制删除
  - -15 以正常方式删除
---
#### ps 
  - -A 显示所有
  - -l 显示叫详细的信息
---
#### top 动态查看进程
  - -b 更新的秒数
  - -n 进行次数
  - -p 针对某个pid
  - 使用过程中可以按以下键
   - ? 查询可使用命令
   - P 按资源排序
   - M 按内存排序
   - N 按照pid排序
   - r 重新制定pid值
---
#### pstree 显示进程树
  - -p 显示pid
  - -u 显示账号
---
#### killall -signal name 杀死进程

#### nice

  PRI值决定了进程的优先级 PRI越低 优先级越高
  PRI(new) = PRI(old) +nice
####  nice renice 设置新的以及跟新nice值

## 账号管理
#### 用户
  - /etc/passwd  
      其中有7个字段 每个字段由:分隔开  
        1.账户名称  
        2.密码 早期的放在这里  现在已经是用x表示  
        3.UID 用户标识符  0 系统管理员 1-499 系统账户 500-65535 给一般用户  
        4.GID 用户组标识符  
        5.用户信息  包括地址 电话等  
        6.主文件夹 即home目录  
        7.使用的shell 如果无法使用shell 这是/sbin/nologin  
  - /etc/shadow
      分9个字段 每个字段由:分隔开
        1.账户名称
        2.密码  这里是加密的面膜
        3.最近更改密码的日期
        4.密码不可更改的时间
        5.密码需要重新更改的时间
        6.密码需要更改提前警告时间
        7.密码过期后宽限时间 (失效后仍能使用)
        8.账号失效时间
        9.保留
  - useradd 
      - -u 设置UID
      - -g 设置初始用户组
      - -G 设置一般用户组
      - -M 不要创建用户主文件夹 (系统账号默认值)
      - -m 创建用户主文件夹 (一般账号默认值)
      - -c 设置个人信息
      - -d 指定某个文件夹为主文件夹 (用绝对路径)
      - -r 创建一个系统账号
      - -s 后面接一个shell 默认是bash
      - -e 后面接一个日期 表示是失效的日期
      - -f 指定密码时候会失效 0表示立即失效 -1为永远不失效
      - -D 显示默认值
  - passwd 更改密码
      - -l 使密码失效
      - -u 与l对应 使密码生效
      - -S 列出密码相关参数
      - -n 后加时间 代表不能修改密码的天数
      - -x 后加时间 代表多久内必须更改密码
      - -w 后加时间 代表密码过期前警告天数
      - -l 后加时间 密码失效天数
  - change 显示密码参数 
      - -l 显示密码详细参数 
      - -的dmMWIE 分别修改低3-8字段
  - usermod 修改用户信息
      - -c 后面接账号说明
      - -d 后面接账号主文件夹
      - -g 修改账号初始用户组
      - -G 修改账号次要用户组
      - -a 增加账号次要用户组
      - -l 后面接账号信息
      - -s 后面接shell实际文件
      - -u 修改UID
      - -L 使用户的密码冻结
      - -U 将密码列的!去掉
  - userdel 删除用户
  - finger 显示用户信息 后面加用户名
      - -s 进列出用户账号,全名,终端机代号和登陆信息
      - -m 列出与后面账号相同者 
  - chfn 修改账号信息
  - chsh 修改shell
    - -l 列出可用的shell
    - -s 修改自己的shell
  - id 显示某一个人的UID和GID信息

#### 用户组
  - /etc/group
      分4个字段 每个字段用:分隔开
        1.用户组名称  
        2.用户组密码 同上
        3.GID
        4.用户组支持账号的名称
  - /etc/gshadow
      分4个字段 每个字段用:分隔开
        1.用户组名
        2.密码列 !表示无合法密码所以没有用户组管理员
        3.用户组管理员账号
        4.改用户组所属的账号(必须和/etc/group) 相同
  有效用户组(effective group) 与 初始用户组(initial group)  
  一个用户在等率系统的时候,立刻拥有初始用户组的权限,初始用户组在passwd中拥有  
  有效用户组指新建文件或者目录时显示的用户组  
  - groups 显示当前用户所处的用户组 第一个显示的就是它的有效用户组
  - newgrp 有效用户组的切换  所切换的有效用户组必须在原有用户组中
  - groupadd 增加用户组 后面跟用户组名字 
      - -g 后面接某个GID
      - -n 修改既有的组名
  - groupdel 删除用户组
  - groupwd 用户组管理员功能 
      - 若无参数 表示给对应groupname一个密码
      - -A 设置管理员账号
      - -M 将某些账号加入该组
      - -r 将该groupname的密码删除
      - -R 将该groupname的密码失效

## 切换身份 
#### su
  - - 使用login-shell 切换 (会使许多环境变量变成root的环境变量)
  - -l 使用login-shell 切换到某一个账号
  - -p/-c 使用当前环境变量
  - -c 仅执行一次命令

#### sudo
  - -u 切换为用户
  - -b 后续由系统自动运行
  修改 /etc/sudoers  
  用户  ALL=可以sudo到的用户 可以操作的行为

## 编译操作
#### make
生成一个makefile的文件
语法:  
#作为注释  
<tab> 需要在命令行第一个字符  
目标和相关文件由:隔开 如main:mian.o sin.o  
